{% extends "base.html" %}
{% block title %}
<title> تقارير الخارج لمصنع {{name}}</title>

{% endblock title %}


{% block css %}

<style>
    .sel .select2-selection__rendered {
        line-height: 31px !important;
        height: 37px !important;
    }
    .sel .select2-container .select2-selection--single {
        height: 37px !important;
        border: 1px solid lightgray;
    }
    .sel .select2-selection__arrow {
        height: 37px !important;
    }
</style>
{% endblock css %}
    

{% block main %}
{% load  crispy_forms_tags %}
    <div class="main-content">

      <div class="page-content">
          <div class="container">
                
                    <div class="row">
                        <div class="col-lg-12 ">
                          <div class="card shadow-lg">
                            <div class="card-body">
                              <!-- خارج المصنع -->
                              <div class="tab-pane" id="processing" role="tabpanel">
                                <div class="row">
                                  <div class="col-lg-12">
                                    <div class="bg-dark">
                                      <div class="row">
                                        <div class="col-lg-12">
                                          <div class="p-3">
                                            <h3
                                              class="text-center font-weight-bold"
                                              style="color: white"
                                            >
                                            <i class="fas fa-file-alt"></i>
                                              تقارير خارج مصنع : <span class="badge badge-danger"> {{name}}</span>
                                            </h3>
                                          </div>
                                        </div>
                                      </div>
                                    </div>
                    
                                    <div class="table-responsive" id="order_list">
                                      <table class="table table-nowrap mb-0">
                                        <thead>
                                          <form method="get" action="#" id="my_form">
                                            <input name="type" type="hidden" value="{{ request.GET.type }}">
                                            <tr>
                                              <th
                                                class="col-lg-6 col-xl-6 col-md-6">
                                                
                                                {{form.from_date|as_crispy_field}}
                                              </th>
                                              <th
                                                class="col-lg-6 col-xl-6 col-md-6"
                                                
                                              >
                                                {{form.to_date|as_crispy_field}}
                                              </th>

                                              <th>
                                                <button type="submit" name="submit" id='search'  value="1" class="btn btn-success"
                                                onclick="document.getElementById('my_form').action = '#'; document.getElementById('my_form').target = '_self' "
                                                >  
                                                    <i class="fas fa-search"></i> 
                                                     بحث
                                                </button>
                                              </th>

                                              <th>
                                                <button type="submit" name="submit" id="print"  value="1" class="btn btn-primary"
                                                onclick="document.getElementById('my_form').action = '{% url 'Factories:PrintOutside' name.id  %}'; document.getElementById('my_form').target = '_blank' "
                                                >  
                                                <i class="fas fa-print"></i> 
                                                  طباعة
                                              </button>
                                              </th>
                                              
                                            </tr>
                                          </form>
                                        </thead>
                                      </table>
                                    </div>
                                    <style>
                                      .table-responsive {
                                        max-height: 500px;
                                      }
                                      .table-responsive::-webkit-scrollbar {
                                        display: none;
                                      }
                                    </style>
                    
                                    <div class="card-body" id="paymnet">
                                      <div class="table-responsive">
                                        <table
                                          class="table table-centered table-dark table-nowrap text-center"
                                        >
                                          <thead style="background-color: #0c2b4b">
                                            <tr>
                                              <th>م</th>
                                              <th>التاريخ</th>
                                              <th>الوزن</th>
                                              <th>اللون</th>
                                              <th>نوع الخامة</th>
                                              <th>نسبة الهالك</th>
                                              <th>الوزن بعد نسبة الهالك</th>
                                              <th>المسئول</th>
                                            </tr>
                                          </thead>
                                          <tbody>
                                            {% for x in object_list %}
                                            <tr style="text-align: center">
                                              <td>{{forloop.counter}}</td>
                                              <td>
                                                <span class="badge badge-danger"
                                                  ><i class="fas fa-calendar-alt"></i>
                                                  {{x.date|date:'Y-m-d'}}</span
                                                >
                                              </td>
                                              <td>
                                                 {{x.weight}}
                                              </td>
                                              <td>
                                                 {{x.color}}
                                              </td>
                                              <td>
                                                 {{x.get_wool_type_display}}
                                              </td>
                                              <td>
                                                 {{x.percent_loss}}
                                              </td>
                                              <td>
                                                 {{x.weight_after_loss}}
                                              </td>
                                              <td>
                                                 {{x.admin}}
                                              </td>
                    
                                            </tr>
                                            {% endfor %}
                                          </tbody>
                                        </table>
                                      </div>

                                      
                                      <div style="margin-top: 10px">
                                        <div class="row">
                                          <div class="col-lg-12">
                                            <div class="card mini-stats-wid mb-0">
                                              <div class="card-body bg-danger">
                                                <div class="d-flex flex-wrap">
                                                  <div class="">
                                                    <h5 class="mb-2 text-light">
                                                      اجمالي الوزن بعد نسبة الهالك
                                                    </h5>
                                                    <h3 class="mb-0 text-dark">
                                                      {{ summary.sum_weight}} كيلو جرام
                                                    </h3>
                                                  </div>

                                                  <div class="avatar-sm ml-auto">
                                                    <div
                                                      class="avatar-title bg-light rounded-circle text-dark font-size-20"
                                                    >
                                                      <i class="fas fa-hand-holding-usd"></i>
                                                    </div>
                                                  </div>
                                                </div>
                                              </div>
                                            </div>
                                          </div>
                                        
                                        </div>
                                      </div>
                                        
                                    </div>
                    
                            
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                



                {% if is_paginated %}
                {% include "components/paginator.html" %}
                {% endif %}

              

          </div>
      </div>
  </div>
{% endblock main %}


{% block js %}

<script>
    $(document).ready(function() {
        $('#product').select2();
         $('#from_date').val(localStorage.getItem('from_date'));
         $('#to_date').val(localStorage.getItem('to_date'));
         document.getElementById('from_date').required = false;
         document.getElementById('to_date').required = false;
    });

    $( '#search' ).on('click', function () {
      var from_date = $('#from_date').val();
      var to_date = $('#to_date').val();
      window.localStorage.setItem("from_date" , from_date);
      window.localStorage.setItem("to_date" , to_date);
  });

    $( '#print' ).on('click', function () {
      window.localStorage.removeItem("from_date");
      window.localStorage.removeItem("to_date");
  });
</script>

>

{% endblock js %}

